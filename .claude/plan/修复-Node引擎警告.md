# Node.js engines ç‰ˆæœ¬çº¦æŸä¿®å¤ - å®æ–½è®¡åˆ’

## æ‰§è¡Œæ—¶é—´
2026-01-18

## ç›®æ ‡
ä¿®å¤ Vercel éƒ¨ç½²è­¦å‘Š: é˜²æ­¢ Node.js 21+ æ„å¤–ä¸»ç‰ˆæœ¬å‡çº§,åŒæ—¶æ»¡è¶³ Next.js 16.1.1 æœ€ä½è¦æ±‚ (Node >= 20.9.0)

## æ‰¹å‡†æ–¹æ¡ˆ
**æ–¹æ¡ˆ A**: ä¿®æ”¹ `package.json` engines.node ä¸º `"^20.9.0"`

---

## ä¿®æ”¹æ¸…å•

### æ–‡ä»¶: package.json
**ä½ç½®**: ç¬¬ 41-42 è¡Œ

**å˜æ›´**:
```diff
"engines": {
-  "node": ">=20.0.0"
+  "node": "^20.9.0"
}
```

**è¯­ä¹‰è¯´æ˜**:
- `^20.9.0` ç­‰ä»·äº `>=20.9.0 <21.0.0`
- âœ… æ»¡è¶³ Next.js 16.1.1 è¦æ±‚ (>= 20.9.0)
- âœ… é˜»æ­¢ Node 21/22+ è‡ªåŠ¨å‡çº§
- âœ… å…è®¸ Node 20.x å®‰å…¨è¡¥ä¸æ›´æ–°

---

## å…¼å®¹æ€§åˆ†æ

### CI/CD ç¯å¢ƒ
| ç¯å¢ƒ | å½“å‰é…ç½® | æ˜¯å¦å…¼å®¹ | è¯´æ˜ |
|------|---------|---------|------|
| GitHub Actions | `node-version: "20"` (.github/workflows/db-migrate.yml:31) | âœ… æ˜¯ | è§£æä¸ºæœ€æ–° 20.x (é€šå¸¸ â‰¥20.10) |
| Vercel | `NODE_VERSION: "20"` (vercel.json) | âœ… æ˜¯ | å¹³å°é»˜è®¤ä½¿ç”¨ 20.x æœ€æ–°ç‰ˆ |

### ä¾èµ–åŒ…å…¼å®¹æ€§
| ä¾èµ– | ç‰ˆæœ¬ | Node 20.9.0 å…¼å®¹æ€§ |
|------|------|-------------------|
| Next.js | 16.1.1 | âœ… è¦æ±‚ >=20.9.0 |
| React | 19.2.3 | âœ… å®Œå…¨æ”¯æŒ |
| esbuild | 0.25.12 (é”å®š) | âš ï¸ éœ€éªŒè¯åŸç”Ÿæ¨¡å— |
| drizzle-kit | 0.31.8 | âš ï¸ éœ€éªŒè¯åŸç”Ÿæ¨¡å— |
| TypeScript | 5.4.5 | âœ… å®Œå…¨æ”¯æŒ |
| Tailwind CSS | 4.1.18 | âœ… å®Œå…¨æ”¯æŒ |

---

## éªŒè¯æ­¥éª¤

### 1. æœ¬åœ°ç¯å¢ƒéªŒè¯
```bash
# æ£€æŸ¥ Node ç‰ˆæœ¬
node -v  # åº”è¾“å‡º v20.9.0 æˆ–æ›´é«˜ (ä¸»ç‰ˆæœ¬=20)

# å®‰è£…ä¾èµ– (ç¡®ä¿ lockfile ä¸€è‡´)
pnpm install --frozen-lockfile

# æ„å»ºéªŒè¯
pnpm run build

# é™æ€æ£€æŸ¥
pnpm run lint

# æ•°æ®åº“å·¥å…·éªŒè¯
pnpm run db:generate
```

### 2. CI/CD è§‚å¯Ÿç‚¹
- **GitHub Actions**: æ„å»ºæ—¥å¿—ä¸­ Node ç‰ˆæœ¬åº”ä¸º `20.x` ä¸” â‰¥20.9.0
- **Vercel Build Logs**: Node ç‰ˆæœ¬åº”ä¸º `20.x` ä¸” â‰¥20.9.0
- **è­¦å‘Šæ¶ˆå¤±**: ä¸å†å‡ºç° "engines will automatically upgrade" è­¦å‘Š

### 3. è¿è¡Œæ—¶éªŒè¯
- éƒ¨ç½²åè®¿é—®åº”ç”¨,ç¡®è®¤æ— è¿è¡Œæ—¶é”™è¯¯
- æ£€æŸ¥ `/api/sync` ç­‰åç«¯ API æ­£å¸¸å“åº”
- éªŒè¯æ•°æ®åº“è¿ç§»è„šæœ¬æ­£å¸¸æ‰§è¡Œ

---

## é£é™©ä¸ç¼“è§£

### æ½œåœ¨é£é™©
| é£é™© | å¯èƒ½æ€§ | å½±å“ | ç¼“è§£æªæ–½ |
|------|-------|------|---------|
| æœ¬åœ°å¼€å‘è€…ä½¿ç”¨ Node <20.9.0 | ä¸­ | pnpm `Unsupported engine` é”™è¯¯ | æ·»åŠ  `.nvmrc` æ–‡ä»¶,æ–‡æ¡£è¯´æ˜å‡çº§æ­¥éª¤ |
| esbuild 0.25.12 ä¸ Node 20.9.0 ä¸å…¼å®¹ | ä½ | æ„å»ºå¤±è´¥ | å·²åœ¨ package.json:46 é€šè¿‡ pnpm overrides é”å®šç‰ˆæœ¬ |
| Vercel å¹³å°è§£æå¤±è´¥ | æä½ | éƒ¨ç½²å¤±è´¥ | vercel.json å·²æœ‰ NODE_VERSION å…œåº• |

### ç¼“è§£æªæ–½
1. **æ·»åŠ  .nvmrc æ–‡ä»¶** (å¯é€‰ä½†æ¨è):
   ```
   20.10.0
   ```
   ç¡®ä¿å›¢é˜Ÿä½¿ç”¨ç»Ÿä¸€ Node ç‰ˆæœ¬

2. **æ›´æ–° README.md** (å¯é€‰):
   æ·»åŠ  Node ç‰ˆæœ¬è¦æ±‚è¯´æ˜:
   ```markdown
   ## å¼€å‘ç¯å¢ƒè¦æ±‚
   - Node.js >= 20.9.0 (æ¨è 20.10+)
   - pnpm (å¯ç”¨ Corepack)
   ```

---

## å›æ»šæ–¹æ¡ˆ

### æ–¹æ¡ˆ 1: ç›´æ¥å›æ»š (æœ€å¿«)
```bash
# æ¢å¤ package.json ç¬¬ 42 è¡Œ
git diff HEAD~1 package.json
git checkout HEAD~1 -- package.json
pnpm install
git commit -m "revert: å›æ»š Node engines ä¿®æ”¹"
git push
```

### æ–¹æ¡ˆ 2: Git Revert (æ¨è)
```bash
# åˆ›å»ºåå‘æäº¤
git revert <commit-hash>
git push
```

---

## åç»­ä¼˜åŒ–å»ºè®® (å¯é€‰)

### å»ºè®® 1: å‡çº§åˆ° Node 20.10.0+
**ç†ç”±**: åŒ…å«é‡è¦å®‰å…¨ä¿®å¤å’Œæ›´å¥½çš„ ESM åŠ è½½ç¨³å®šæ€§

**ä¿®æ”¹**:
```json
"engines": {
  "node": "^20.10.0"
}
```

### å»ºè®® 2: æ·»åŠ  pnpm ç‰ˆæœ¬çº¦æŸ
**å½“å‰é—®é¢˜**: package.json æœªçº¦æŸ pnpm ç‰ˆæœ¬

**å»ºè®®æ·»åŠ **:
```json
"engines": {
  "node": "^20.9.0",
  "pnpm": ">=9.0.0"
}
```

### å»ºè®® 3: ç»Ÿä¸€ç‰ˆæœ¬ç®¡ç†
åˆ›å»º `.nvmrc` æ–‡ä»¶:
```
20.10.0
```

å›¢é˜Ÿæˆå‘˜å¯ä½¿ç”¨:
```bash
nvm use  # è‡ªåŠ¨åˆ‡æ¢åˆ°é¡¹ç›®è¦æ±‚çš„ Node ç‰ˆæœ¬
```

---

## å®¡æ‰¹ç¡®è®¤

- [x] Codex åç«¯è§„åˆ’å®¡æ‰¹ (SESSION: 019bd09c-8575-72d1-979c-07e4cffdea75)
- [x] Gemini å‰ç«¯è§„åˆ’å®¡æ‰¹ (SESSION: 138dbe97-e690-40b0-b18e-6235661632e0)
- [ ] ç”¨æˆ·æœ€ç»ˆæ‰¹å‡†

## å®æ–½æ—¶é—´çº¿

| é˜¶æ®µ | é¢„è®¡æ—¶é—´ | è´Ÿè´£äºº |
|------|---------|-------|
| ä¿®æ”¹ package.json | 1 åˆ†é’Ÿ | Claude (æ‰§è¡Œ) |
| æœ¬åœ°éªŒè¯ | 5 åˆ†é’Ÿ | Claude (æ‰§è¡Œ) |
| æäº¤å˜æ›´ | 2 åˆ†é’Ÿ | ç”¨æˆ·ç¡®è®¤ |
| CI/Vercel éªŒè¯ | 10 åˆ†é’Ÿ | è‡ªåŠ¨åŒ– |

---

## é™„å½•: Codex ä¸ Gemini åˆ†ææ‘˜è¦

### Codex å»ºè®®
- âœ… æ¨èæ–¹æ¡ˆ A (`^20.9.0`) ç®€æ´ä¸”ç²¾ç¡®
- âœ… ç¡®è®¤æ»¡è¶³ Next.js >= 20.9.0 è¦æ±‚
- âœ… GitHub Actions å’Œ Vercel é…ç½®å…¼å®¹

### Gemini å»ºè®®
- âš ï¸ åˆå§‹æ¨è `^20.0.0` (ä¸æ»¡è¶³ Next.js è¦æ±‚,å·²çº æ­£)
- âœ… è¯†åˆ« esbuild é”å®šé£é™©
- âœ… å»ºè®®æ·»åŠ  .nvmrc æ–‡ä»¶ç»Ÿä¸€å¼€å‘ç¯å¢ƒ
- ğŸ”¹ å¯é€‰ä¼˜åŒ–: å‡çº§åˆ° `^20.10.0` è·å¾—æ›´å¥½ç¨³å®šæ€§
